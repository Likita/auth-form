const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/__vite-browser-external-iJXIPR-c.js","assets/entry.client-ClPR750A.js"])))=>i.map(i=>d[i]);
const p="modulepreload",b=function(s){return"/auth-form/"+s},f={},U=function(n,t,a){let o=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(e==null?void 0:e.nonce)||(e==null?void 0:e.getAttribute("nonce"));o=Promise.allSettled(t.map(u=>{if(u=b(u),u in f)return;f[u]=!0;const w=u.endsWith(".css"),h=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const c=document.createElement("link");if(c.rel=w?"stylesheet":p,w||(c.as="script"),c.crossOrigin="",c.href=u,r&&c.setAttribute("nonce",r),document.head.appendChild(c),w)return new Promise((g,E)=>{c.addEventListener("load",g),c.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${u}`)))})}))}function d(e){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=e,window.dispatchEvent(r),!r.defaultPrevented)throw e}return o.then(e=>{for(const r of e||[])r.status==="rejected"&&d(r.reason);return n().catch(d)})};class i extends Error{constructor(n){super(n),this.name="DatabaseError"}}const k="auth-form-db",l="users",P=1;async function m(){try{return await new Promise((s,n)=>{const t=indexedDB.open(k,P);t.onerror=()=>{var a;n(new i(`Failed to open database: ${((a=t.error)==null?void 0:a.message)||"Unknown error"}`))},t.onsuccess=()=>s(t.result),t.onupgradeneeded=a=>{try{const o=a.target.result;o.objectStoreNames.contains(l)||o.createObjectStore(l,{keyPath:"email"})}catch(o){n(new i(`Failed to upgrade database: ${o instanceof Error?o.message:"Unknown error"}`))}}})}catch(s){throw new i(`Database initialization failed: ${s instanceof Error?s.message:"Unknown error"}`)}}async function $(s,n,t){try{const a=await m(),o=await y(n);await new Promise((d,e)=>{try{const r=a.transaction(l,"readwrite"),u=r.objectStore(l),w={email:s,password:o,name:t},h=u.put(w);h.onerror=()=>{var c;e(new i(`Failed to add user: ${((c=h.error)==null?void 0:c.message)||"Unknown error"}`))},r.oncomplete=()=>d(),r.onerror=()=>{var c;e(new i(`Transaction failed: ${((c=r.error)==null?void 0:c.message)||"Unknown error"}`))},h.onsuccess=()=>d()}catch(r){e(new i(`Add user operation failed: ${r instanceof Error?r.message:"Unknown error"}`))}})}catch(a){throw new i(`Failed to add user: ${a instanceof Error?a.message:"Unknown error"}`)}}async function S(s){try{const n=await m();return await new Promise((t,a)=>{try{const o=n.transaction(l,"readonly"),e=o.objectStore(l).get(s);e.onerror=()=>{var r;a(new i(`Failed to get user: ${((r=e.error)==null?void 0:r.message)||"Unknown error"}`))},o.onerror=()=>{var r;a(new i(`Transaction failed: ${((r=o.error)==null?void 0:r.message)||"Unknown error"}`))},e.onsuccess=()=>t(e.result)}catch(o){a(new i(`Get user operation failed: ${o instanceof Error?o.message:"Unknown error"}`))}})}catch(n){throw new i(`Failed to get user: ${n instanceof Error?n.message:"Unknown error"}`)}}async function v(s,n){try{return await y(s)===n}catch(t){throw new i(`Password verification failed: ${t instanceof Error?t.message:"Unknown error"}`)}}async function y(s){try{if(typeof window>"u"||!crypto.subtle){const{createHash:d}=await U(async()=>{const{createHash:e}=await import("./__vite-browser-external-iJXIPR-c.js").then(r=>r._);return{createHash:e}},__vite__mapDeps([0,1]));return d("sha256").update(s).digest("hex")}const t=new TextEncoder().encode(s),a=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(a)).map(d=>d.toString(16).padStart(2,"0")).join("")}catch(n){throw new i(`Password hashing failed: ${n instanceof Error?n.message:"Unknown error"}`)}}export{$ as a,S as g,v};
