import{r,j as f}from"./chunk-GNGMS2XR-Jtfxgobp.js";import{g as h,v as w}from"./db-Bh1l67W4.js";const c=r.createContext(null);function A({children:s}){const[a,o]=r.useState(null),[n,l]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const t=localStorage.getItem("user");if(t){const e=JSON.parse(t);e&&e.email&&o(e)}}catch(t){console.error("Failed to parse stored user:",t),localStorage.removeItem("user")}finally{l(!1)}})()},[]);const d=async(i,t)=>{const e=await h(i);if(!e)throw new Error("No account found with this email address");if(!await w(t,e.password))throw new Error("Incorrect password");const u={email:e.email,name:e.name};o(u),localStorage.setItem("user",JSON.stringify(u))},m=()=>{o(null),localStorage.removeItem("user")};return n?null:f.jsx(c.Provider,{value:{user:a,isAuthenticated:!!a,isLoading:n,login:d,logout:m},children:s})}function v(){const s=r.useContext(c);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s}export{A,v as u};
